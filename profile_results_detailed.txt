Profile Results
Model: AlphaZeroNet_20x256_distributed.pt
Rollouts: 500
Threads: 10
Stats: {'total_nodes': 5001.0, 'elapsed': 8.119580541000001, 'nps': 615.9185163257314, 'duplicate_paths': 15}

         10467934 function calls (10307614 primitive calls) in 8.119 seconds

   Ordered by: cumulative time
   List reduced from 205 to 50 due to restriction <50>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      500    0.008    0.000    8.111    0.016 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/MCTS.py:499(parallelRollouts)
      500    0.026    0.000    8.103    0.016 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/MCTS.py:422(parallelRolloutsOptimized)
      500    0.088    0.000    5.558    0.011 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/encoder.py:367(callNeuralNetworkBatched)
79158/501    0.029    0.000    2.217    0.004 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py:1747(_wrapped_call_impl)
79158/501    0.044    0.000    2.217    0.004 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py:1755(_call_impl)
      501    0.023    0.000    2.216    0.004 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/AlphaZeroNetwork.py:169(forward)
    10020    0.245    0.000    1.971    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/AlphaZeroNetwork.py:54(forward)
      518    0.001    0.000    1.695    0.003 /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/threading.py:280(wait)
     5000    0.003    0.000    1.695    0.000 /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/concurrent/futures/_base.py:417(result)
     1076    1.694    0.002    1.694    0.002 {method 'acquire' of '_thread.lock' objects}
     1002    1.664    0.002    1.664    0.002 {method 'cpu' of 'torch._C.TensorBase' objects}
    21543    0.036    0.000    0.969    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py:159(forward)
    21543    0.013    0.000    0.911    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py:2791(batch_norm)
    21543    0.892    0.000    0.892    0.000 {built-in method torch.batch_norm}
   503727    0.091    0.000    0.829    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:3702(generate_legal_moves)
     5000    0.001    0.000    0.754    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/MCTS.py:248(expand)
     4986    0.185    0.000    0.752    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/MCTS.py:49(__init__)
     5001    0.004    0.000    0.673    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/encoder.py:278(encodePositionForInference)
   505902    0.182    0.000    0.551    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:1819(generate_pseudo_legal_moves)
    21543    0.014    0.000    0.498    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/conv.py:553(forward)
    21543    0.008    0.000    0.478    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/conv.py:536(_conv_forward)
    21543    0.470    0.000    0.470    0.000 {built-in method torch.conv2d}
     5001    0.057    0.000    0.453    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/encoder.py:300(decodePolicyOutput)
     1002    0.434    0.000    0.434    0.000 {method 'to' of 'torch._C.TensorBase' objects}
     5001    0.037    0.000    0.402    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/encoder.py:207(getLegalMoveMask)
    22044    0.006    0.000    0.318    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/activation.py:132(forward)
    22044    0.006    0.000    0.312    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py:1693(relu)
    22044    0.305    0.000    0.305    0.000 {built-in method torch.relu}
   162673    0.199    0.000    0.215    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/MCTS.py:191(__init__)
   326066    0.155    0.000    0.213    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/encoder.py:133(moveToIdx)
     5001    0.043    0.000    0.181    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/encoder.py:30(encodePosition)
   491067    0.092    0.000    0.158    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:3664(_is_safe)
   569060    0.145    0.000    0.145    0.000 <string>:2(__init__)
  1082838    0.108    0.000    0.128    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:414(scan_reversed)
      501    0.003    0.000    0.088    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/AlphaZeroNetwork.py:91(forward)
     2488    0.001    0.000    0.086    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:3843(mirror)
     7988    0.007    0.000    0.085    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:3858(copy)
    17196    0.029    0.000    0.065    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:3738(generate_castling_moves)
     7988    0.004    0.000    0.057    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:3877(<listcomp>)
      501    0.002    0.000    0.054    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/AlphaZeroNetwork.py:124(forward)
      501    0.001    0.000    0.053    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/AlphaZeroNetwork.py:22(forward)
    27368    0.019    0.000    0.053    0.000 /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/copy.py:66(copy)
   222945    0.045    0.000    0.045    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py:1927(__getattr__)
   905697    0.042    0.000    0.042    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:262(square_rank)
   117846    0.041    0.000    0.041    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:875(attacks_mask)
    77993    0.024    0.000    0.040    0.000 /Users/rishisachdev/Documents/GitHub/pytorch-alpha-zero/encoder.py:225(mirrorMove)
   855530    0.037    0.000    0.037    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:258(square_file)
     1503    0.001    0.000    0.037    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/linear.py:124(forward)
    43695    0.035    0.000    0.035    0.000 /Users/rishisachdev/Library/Python/3.9/lib/python/site-packages/chess/__init__.py:905(attackers_mask)
     1503    0.035    0.000    0.035    0.000 {built-in method torch._C._nn.linear}


